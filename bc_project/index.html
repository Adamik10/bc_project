<% /*Add this to engage logon requirement */ %>
<%@ page import="xtk:shared/nl.js" %>
<% NL.require('xtk:jsspcontext.js'); %>
<%
  if( !(new NL.JSSPContext(request)).checkAuthentication(response) )
    return;
%>

<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <!-- below is FONT -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
  <!-- below is vuetify -->
  <link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">
  <!-- below is vue functionalities -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
  <!-- AXIOS -->
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <!-- below is moment -->
  <script src="https://momentjs.com/downloads/moment-with-locales.js"></script>
  <!-- below is material icons -->
  <link rel="icon" sizes="192x192" href="https://material.io/static/images/simple-lp/favicons/components-192x192.png">
  <link rel="shortcut icon" href="https://material.io/static/images/simple-lp/favicons/components-72x72.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/6.0.0/normalize.min.css">
  <!-- below is bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- below css is temporary 
  <link rel="stylesheet" type="text/css" href="css/style.css">-->
  <style>
/* sass --watch style.scss style.css */
* {
  position: relative;
}
*::-webkit-scrollbar {
  background-color: rgba(255, 255, 255, 0);
  width: 3px;
}
*::-webkit-scrollbar-thumb {
  background-color: #3A9EF0;
  width: 3px;
}

/* INDEX ------------------------------------------------------------------------- INDEX */
.v-toolbar__title {
  overflow: visible !important;
}

.navLogo {
  height: 50px;
}

.sidebar-tile {
  border-top: rgba(0, 0, 0, 0.03) 1px solid;
}

.sidebar-tile:last-child {
  border-bottom: rgba(0, 0, 0, 0.03) 1px solid;
}

.sidebar-tile a {
  height: 90px;
}

.action-margin-left {
  margin-left: 30px;
}

.action-icon-circle {
  width: 50px;
  height: 50px;
  border-radius: 30px;
  background-color: #B8C2CC;
  display: flex;
}

.action-icon-circle .icon {
  color: rgba(255, 255, 255, 0.815);
  font-size: 25px;
  margin: auto;
}

.sidebar-spacer {
  position: relative;
  display: block;
  height: 100px;
}

.sidebar-spacer .close {
  position: absolute;
  right: 35px;
  top: 25px;
  color: #9ca5ad;
  font-size: 40px;
  cursor: pointer;
}

.nav-spacer {
  height: 70px;
  width: 100%;
  display: block;
}

.footer {
  width: 100vw;
}

.footer .footer-card {
  width: 100%;
}

.inline-block {
  display: inline-block;
}

.footer-icon-text {
  margin-left: 50px;
}

.footer-icon-text:first-of-type {
  margin-left: 0px;
}

/* OFFERS OVERVIEW ----------------------------------------------------------- OFFERS OVERVIEW */
.addNewButton {
  margin-top: 70px;
}

.baseCard {
  position: relative;
  display: inline-block;
  width: 340px;
  border-radius: 2px;
  position: relative;
  margin-right: 30px;
  margin-bottom: 30px;
}
.baseCard.clickable {
  cursor: pointer;
}
.baseCard .card-title {
  display: block;
  margin: 0 !important;
}
.baseCard .headline {
  font-size: 17px !important;
  line-height: 17px !important;
  font-weight: 800;
  display: block;
  margin-top: -5px;
  margin-bottom: 14px;
}
.baseCard .status-container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
}
.baseCard .status-container.green {
  background-color: #6DC570;
}
.baseCard .status-container.red {
  background-color: #FF6D6D;
}
.baseCard .v-expansion-panel__header {
  padding: 0px !important;
}
.baseCard .v-expansion-panel__container {
  max-width: 100% !important;
}
.baseCard .v-card__text {
  padding: 10px 0px 0px 0px !important;
}
.baseCard .v-card__text div {
  padding-bottom: 10px;
}
.baseCard .v-expansion-panel__container--active {
  box-shadow: none !important;
}
.baseCard .v-expansion-panel--popout {
  margin-bottom: 0 !important;
}
.baseCard .margin-auto {
  margin: auto;
}
.baseCard .v-card__title {
  line-height: 1.15 !important;
}

.offer-content {
  min-width: 100%;
}

/* FILTERS --------------------------------------------------------------------- FILTERS */
.dropdownContainer {
  border-radius: 3px;
  padding: 0;
  min-width: 15em;
  width: 200px;
  display: inline-block;
  margin-right: 5px;
}
.dropdownContainer .basicDropdown {
  display: inline-block;
  outline-color: #3A9EF0;
  margin-right: 300px;
  width: 200px;
  cursor: pointer;
  border-radius: 5px;
  height: 50px;
}
.inputContainer {
  width: 300px;
  display: inline-block;
  margin-bottom: -35px;
  margin-top: -20px;
}
.inputContainer .basicInput {
  width: 100%;
}

/* DETAIL OFFER --------------------------------------------------------------------- DETAIL OFFER */
.long-title {
  overflow: visible !important;
}

.greenBackground {
  background-color: #6DC570 !important;
}

.redBackground {
  background-color: #FF6D6D !important;
}

.blueBackground {
  background-color: #3A9EF0 !important;
}

.display-flex {
  display: flex;
  width: 100%;
  height: 100%;
  justify-content: center;
  align-items: flex-start;
  flex-wrap: wrap;
}
.display-flex .mobile-preview {
  position: relative;
  padding-top: 30px;
  width: 500px;
}
.display-flex .mobile-preview .phone {
  width: 100%;
}
.display-flex .mobile-preview__container {
  width: 300px;
  display: block;
  position: relative;
  margin-left: auto;
  margin-right: auto;
}
.display-flex .mobile-preview__container-content {
  position: absolute;
  top: 5px;
  left: 7px;
  width: 285px;
  height: 615px;
  border-radius: 30px;
  overflow-x: auto;
  overflow-y: auto;
  padding-top: 30px;
  box-shadow: 0px 5px 10px #a8a8a8;
}
.display-flex .desktop-preview {
  padding-top: 30px;
  width: 1000px;
}
.display-flex .desktop-preview__container {
  width: 900px;
  display: block;
  position: relative;
  margin-left: 0px;
  margin-right: auto;
}
.display-flex .desktop-preview__container-content {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 900px;
  max-height: 700px;
  border-radius: 3px;
  overflow-x: auto;
  overflow-y: auto;
  box-shadow: 2px 2px 15px #5a5a5a;
  padding-top: 20px;
  padding-bottom: 20px;
}
.display-flex .sidebar {
  padding: 20px;
  padding-top: 30px;
  width: 400px;
  height: 90vh;
}
.display-flex .sidebar .minus-margin {
  margin-top: -16px;
}
.display-flex .sidebar .display-flex {
  height: auto;
}
.display-flex .sidebar .display-flex .half-width p {
  margin-bottom: 0px;
}

.no-padding {
  padding: 0 0 !important;
  margin-top: -10px;
}
.no-padding.v-subheader {
  padding: 0 0 !important;
  margin-top: -10px;
  color: silver;
}

.align-right {
  text-align: right;
}

.full-width {
  width: 100%;
}

.half-width {
  width: 50%;
}

.center-text {
  text-align: center;
}

.base-button {
  height: 40px;
  width: 100px;
  color: white;
  border-radius: 5px;
  text-align: center;
  line-height: 40px;
  cursor: pointer;
  border: 1px solid silver;
  color: silver;
  background-color: rgba(255, 255, 255, 0);
}
.base-button.full-width {
  width: 100%;
  margin: 0 auto;
}

.spacer {
  display: block;
  width: 100%;
  height: 20px;
}
.spacer-big {
  display: block;
  width: 100%;
  height: 30px;
}

/* NEW OFFER --------------------------------------------------------------------- NEW OFFER */
.basicInputContainer {
  display: block;
}
.basicInputContainer.special {
  display: block;
  padding-right: 10px;
}
.basicInputContainer .basicInput {
  width: 100%;
  margin-right: 5px;
}
.basicInputContainer .v-text-field {
  padding-top: 0px;
  margin-top: 0px;
}
.basicInputContainer .v-text-field .v-input__slot {
  margin-bottom: 2px;
}

.dropdownContainerForm {
  border-radius: 5px;
  padding: 0;
  width: 202px;
  display: inline-block;
  margin-right: 5px;
}
.dropdownContainerForm .basicDropdownForm {
  display: inline-block;
  width: 100%;
  border-radius: 5px;
  height: 50px;
}
.dropdownContainerForm .basicDropdownForm .v-input__control {
  border-radius: 5px;
}
.dropdownContainerForm .basicDropdownForm .v-input__control .v-input__slot {
  border: solid 1px #e2e2e2;
  border-radius: 5px;
}
.dropdownContainerForm .basicDropdownForm .v-input__control .v-select__selection {
  overflow: hidden;
  text-overflow: ellipsis;
}
.new-offer-dialog {
  overflow-x: hidden;
  overflow-y: hidden;
  background-color: #FAFAFA !important;
}
.new-offer-dialog .v-card {
  overflow-x: hidden;
  overflow-y: hidden;
}
.new-offer-dialog .leftSide {
  display: inline-block;
  position: relative;
  width: 478px;
  min-height: 100%;
  padding: 30px 15px 30px 40px;
}
.new-offer-dialog .rightSide {
  display: inline-block;
  position: relative;
  width: 718px;
  min-height: 100%;
  padding: 30px 40px 30px 15px;
}
.new-offer-dialog .rightSide .previewContainer {
  width: 100%;
  height: 500px;
  display: block;
  position: relative;
  margin-left: auto;
  margin-right: auto;
  margin-top: 20px;
}
.new-offer-dialog .rightSide .previewContainer-content {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 100%;
  height: 500px;
  max-height: 500px;
  border-radius: 0px;
  overflow-x: auto;
  overflow-y: auto;
  box-shadow: 0px 5px 15px #a8a8a8;
  padding-top: 20px;
  padding-bottom: 20px;
}

.float-right {
  float: right;
}

.float-left {
  float: right;
}

.dialog-title {
  font-size: 1.2rem;
  font-weight: 700;
}

/*# sourceMappingURL=style.css.map */

  </style>
</head>

<body>
  <v-app id="app">
    <!-- Navigation -------------------------------------------------------------------------------------------------------->   
    <v-toolbar  absolute 
                dark 
                color="#3A9EF0"
                height="70px">
      <v-toolbar-side-icon  @click.native.stop="sidebar = !sidebar"></v-toolbar-side-icon>
      <v-toolbar-title class="white--text">UFS Offer Dashboard</v-toolbar-title>
      <v-spacer></v-spacer>
      <img src="https://unilever-stage.neolane.net/res/unilever_stage/82b11d94f8b6e520f06ce3334218952d.png" alt="logo" class="navLogo" style="margin-right: 300px;">
      <v-spacer></v-spacer>
    </v-toolbar>
    <v-navigation-drawer  v-model="sidebar"
                          absolute
                          width="400px"
                          temporary>
      <v-list>
        <div class="sidebar-spacer">
          <v-icon class="close"
                  @click="sidebar = false">
              close
          </v-icon>
        </div>
        <template v-for="subPage in subPages">
          <v-list-tile  :key="subPage.id"
                        @click="redirectTo(subPage.link)"
                        class="sidebar-tile">
            <v-list-tile-action class="action-margin-left">
              <div class="action-icon-circle">
                <v-icon color="white"
                        class="icon">
                  {{ subPage.icon }}
                </v-icon>
              </div>
            </v-list-tile-action>
            <v-subheader class="mx-4">
              {{ subPage.name }}
            </v-subheader>
          </v-list-tile>
        </template>
      </v-list>
    </v-navigation-drawer>
    <div class="nav-spacer"></div>
    <!-- Navigation ends -->

    <!-- Content -->
    <v-container grid-list-xl>
      <!-- Filters -------------------------------------------------------------------------------------------------------->
      <template v-if="filters != undefined">
        <v-container class="dropdownContainer">
          <v-select :items="filters.countries"
                    v-model="filtersSelected.country"
                    label="Country"
                    item-text="marketLabel"
                    item-value="marketCountryCode"
                    clearable dense single-line solo flat
                    class="basicDropdown"
                  :menu-props="{contentClass:'basicDropdownContent'}">
            <template slot="selection" slot-scope="data">
              {{ data.item.marketLabel | maxLength(13) }}
            </template>
          </v-select>
        </v-container>
        <v-container class="dropdownContainer">
          <v-select :items="staticFilters.categories"
                    v-model="filtersSelected.category"
                    label="Category"
                    item-text="categoryLabel"
                    item-value="categoryRef"
                    clearable dense single-line solo flat
                    class="basicDropdown"
                  :menu-props="{contentClass:'basicDropdownContent'}">
            <template slot="selection" slot-scope="data">
              {{ data.item.categoryLabel | maxLength(12) }}
            </template>
          </v-select>
        </v-container>
        <v-container class="dropdownContainer">
          <v-select :items="staticFilters.status"
                    v-model="filtersSelected.status"
                    label="Status"
                    item-text="name"
                    item-value="name"
                    clearable dense single-line solo flat
                    class="basicDropdown"
                    :menu-props="{contentClass:'basicDropdownContent'}">
            <template slot="selection" slot-scope="data">
              {{ data.item.name | maxLength(13) }}
            </template>
          </v-select>
        </v-container>
        <v-container class="inputContainer">
          <v-text-field v-model="filtersSelected.label"
                        label="Label contains"
                        class="basicInput">
          </v-text-field>
        </v-container>
      </template>
      <!-- Filters end -->
      <v-divider ></v-divider>
      <!-- Search results ---------------------------------------------------------------------------------- -->
      <template v-if="offers.length">
        <v-hover v-for="(offer,i) in offers" :key="i">
          <v-card class="baseCard clickable align-top" 
                  align="top"
                  slot-scope="{ hover }"
                  :class="`elevation-${hover ? 12 : 2}`"
                  @click="openDetailView(offer)">
              <v-card-title primary-title class="card-title" >
                <div class="status-container" :class="{greenBackground: offer.statusLive == 6, redBackground: offer.statusLive != 6}"></div>
                <h3 class="headline" :title="offer.offerLabel">{{ offer.offerLabel | maxLength(30) }} </h3>
                <v-card-text>
                  <div><b>SL 1:</b>
                    {{offer.subject1}}</div>
                <div><b>SL 2:</b>
                    {{offer.subject2}}</div>
                <div><b>Pre Header:</b>
                  {{offer.preheader}}</div>
                </v-card-text>
              
              </v-card-title>
            <v-img v-if="offer.imageDesktopURL" :src="'http://'+offer.imageDesktopURL" aspect-ratio="2"></v-img>
            <v-card-title class="text-center center">
              <div v-if="offer.headline" class="margin-auto offer-content" style="font-family:Verdana; font-weight:bold; mso-line-height-rule:exactly; line-height:22px !important; font-size:21px; color:#ff5a00; padding:0 0 8px 0;">{{offer.headline}}</div>
              <div v-if="offer.copyText" class="offer-content" style="padding: 0 0 16px 0">{{offer.copyText}}</div>
              <div v-if="offer.CTAtext" style="margin: auto; padding:6px 14px; -webkit-border-radius:4px; border-radius:4px; font-size:14px; font-family:Verdana; color:#ffffff; display:inline-block; border:1px solid #ff5a00; background-color: #ff5a00;">
                <a :href="offer.destinationURL" style="font-size:14px; font-family:Verdana; text-decoration:none; font-weight:bold; mso-line-height-rule:exactly; 
                  line-height:14px !important; color:#ffffff;" target="_blank">{{offer.CTAtext}}</a>
              </div>
            </v-card-title>
          </v-card>
        </v-hover>
        <div>
          <v-btn v-on:click="loadMoreOffers()" depressed large center>Load more</v-btn>
        </div>
        <div>
          <v-btn v-on:click="createNewOffer()" depressed large center>Create offer test</v-btn>
        </div>
      </template>
      
      <template v-else>
        <v-container>There are no offers to display</v-container>
      </template>

      <v-btn fab dark class="blueBackground addNewButton" @click="openNewOfferDialog()"
        fixed right top>
          <v-icon dark>add</v-icon>
      </v-btn>
      <!-- Search results end  -->
    </v-container>
    <!-- Detailed offer view -------------------------------------------------------------------------------------------------------->
    <v-dialog v-model="detailOfferView" 
              fullscreen hide-overlay 
              transition="dialog-bottom-transition"
              content-class="detailViewContent">
      <v-card v-if="detailOfferData != {} && detailOfferData != undefined && detailOfferData != null">
        <v-toolbar dark :class="{greenBackground: detailOfferData.statusLive == 6, redBackground: detailOfferData.statusLive != 6}">
          <v-toolbar-title class="long-title">{{ detailOfferData.offerLabel }}</v-toolbar-title>
          <v-spacer></v-spacer>
          <v-btn icon dark @click="closeDetailView()">
            <v-icon>close</v-icon>
          </v-btn>
        </v-toolbar>
        <div class="display-flex">
          <div class="mobile-preview">
            <v-subheader class="center-text full-width"><p class="center-text full-width">Mobile preview</p></v-subheader>
            <div class="mobile-preview__container">
              <img src="http://unilever-stage.neolane.net/res/unilever_stage/a48bed274267d6735f4a0dc9435c9dfc.png" alt="phone" class="phone">
              <div class="mobile-preview__container-content">
                <!-- Mobile preview -->
                <table border="0" width="100%" cellpadding="0" cellspacing="0" bgcolor="#ffffff" style="border-collapse: collapse">
                  <tbody style="display: table-row-group; vertical-align: middle; border-color: inherit;">
                    <tr style="display: table-row; vertical-align: inherit; border-color: inherit; border-collapse: collapse">
                      <td align="center" valign="top">
                        <table border="0" width="100%" cellpadding="0" cellspacing="0" bgcolor="#ffffff" style="width:100%!important;max-width:100%!important; border-collapse:collapse">
                          <tbody style="display: table-row-group; vertical-align: middle; border-color: inherit; border-collapse: collapse">
                            <tr style="display: table-row; vertical-align: inherit; border-color: inherit; border-collapse:collapse">
                              <td align="left" valign="top" style="padding:0 10px 30px 10px;" style="padding-left: 0 !important; padding-right:0!important">
                                <table border="0" width="100%" cellspacing="0" cellpadding="0">
                                  <tbody style="display: table-row-group; vertical-align: middle; border-color: inherit;">
                                    <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                      <th valign="top" style="font-weight: normal; padding: 0; vertical-align: top; display: block; padding-right: 0 !important; 
                                        padding-left: 0 !important; width: 100%;">
                                        <table cellpadding="0" cellspacing="0" style="height:381px;table-layout: fixed; margin-top:30px !important; 
                                          width: 100% !important; max-width: 100% !important; border-collapse: collapse;" align="left" border="0">
                                          <tbody style="display: table-row-group; vertical-align: middle; border-color: inherit; border-collapse: collapse;">
                                            <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                              <td v-if="detailOfferData.headline && detailOfferData.headline != '' && detailOfferData.headline != undefined && detailOfferData.headline != null" 
                                                style="font-family:Verdana; color:#000000; font-size:17px; mso-line-height-rule:exactly; line-height:20px; 
                                                height: 90px; overflow: hidden; max-width: 173px; max-height: 120px;" valign="top" align="left">
                                                {{ detailOfferData.headline }}
                                              </td>
                                            </tr>
                                            <tr style="display:none; width:0; max-height:0; overflow:hidden; float:left; display: table-row !important;
                                              width: auto !important; max-height: inherit !important; overflow: visible !important; float: none !important;">
                                              <td style="display:none; width:0; max-height:0; overflow:hidden; float:left; display: table-cell !important;
                                                width: auto !important; max-height: inherit !important; overflow: visible !important; float: none !important;">
                                                <a :href="detailOfferData.destinationURL" target="_blank" style="text-decoration:none; color: -webkit-link; cursor: pointer;">
                                                  <template v-if="detailOfferData.imageMobileURL && detailOfferData.imageMobileURL != '' && detailOfferData.imageMobileURL != undefined && detailOfferData.imageMobileURL != null">
                                                    <img :src="'http://'+detailOfferData.imageMobileURL" :alt="detailOfferData.imageAltText" border="0" 
                                                    style="display: block; width: 265px"/>
                                                  </template>
                                                  <template v-else>
                                                    <img v-if="detailOfferData.imageDesktopURL && detailOfferData.imageDesktopURL != '' && detailOfferData.imageDesktopURL != undefined && detailOfferData.imageDesktopURL != null"
                                                      :src="'http://'+detailOfferData.imageDesktopURL" :alt="detailOfferData.imageAltText" border="0" 
                                                      style="display: block; width: 265px"/>
                                                  </template>
                                                </a>
                                              </td>
                                            </tr>
                                            <tr v-if="detailOfferData.copyText && detailOfferData.copyText != '' && detailOfferData.copyText != undefined && detailOfferData.copyText != null"
                                              style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                              <td align="left" valign="top" style="font-family:Verdana; line-height:17px; font-size:13px; 
                                                color:#000000; padding:16px 0 16px 0;">
                                                {{ detailOfferData.copyText }}
                                              </td>
                                            </tr>
                                            <tr v-if="detailOfferData.CTAtext && detailOfferData.CTAtext != '' && detailOfferData.CTAtext != undefined && detailOfferData.CTAtext != null"
                                                style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                              <td align="center" style="padding:0 0 0 0; border-collapse: collapse">
                                                <table style="border-collapse: collapse">
                                                  <tbody>
                                                    <tr>
                                                      <th bgcolor="#ff5a00" style="padding:6px 14px; -webkit-border-radius:4px; border-radius:4px; font-size:14px; 
                                                          font-family:Verdana; color:#ffffff; display:inline-block; border:1px solid #ff5a00;">
                                                        <a :href="detailOfferData.destinationURL" style="font-size:14px; font-family:Verdana;line-height:14px; 
                                                            text-decoration:none; font-weight:bold; mso-line-height-rule:exactly; color:#ffffff;" target="_blank">
                                                          {{ detailOfferData.CTAtext }}
                                                        </a>  
                                                      </th>
                                                    </tr>
                                                  </tbody>
                                                </table>
                                              </td>
                                            </tr>
                                          </tbody>
                                        </table>
                                      </th>
                                    </tr>
                                  </tbody>
                                </table>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <!-- Mobile preview ends -->
              </div>
            </div>
          </div>
          <div class="desktop-preview">
            <v-subheader class="center-text full-width" style="width: 900px"><p class="center-text full-width">Desktop preview</p></v-subheader>
            <div class="desktop-preview__container">
              <div class="desktop-preview__container-content">
                <!-- Desktop preview -->
                <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#ffffff">
                  <tbody style="display: table-row-group; vertical-align: middle; border-color: inherit; border-collapse: collapse">
                    <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                      <td align="center" valign="top" style="border-collapse: collapse">
                        <table cellpadding="0" cellspacing="0" bgcolor="#ffffff" style="width:600px; border-collapse: collapse;">
                          <tbody style="display: table-row-group; vertical-align: middle; ">
                            <tr style="display: table-row; vertical-align: inherit;">
                              <td align="left" valign="top" style="border-collapse: collapse">
                                <table style="border:0; width:100%">
                                  <tbody style="display: table-row-group">
                                    <tr style="display: table-row;">
                                      <td style="padding:0 10px 16px 10px">
                                        <a :href="detailOfferData.destinationURL" target="_blank">
                                          <img v-if="detailOfferData.imageDesktopURL && detailOfferData.imageDesktopURL != '' && detailOfferData.imageDesktopURL != undefined && detailOfferData.imageDesktopURL != null"
                                            :src="'http://'+detailOfferData.imageDesktopURL" :alt="detailOfferData.imageAltText" style="display:block; width: 580px;">
                                        </a>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </td>
                            </tr>
                            <tr style="display: table-row;">
                              <td dir="ltr" valign="top" style="padding:0 20px 0 20px; border-collapse: collapse">
                                <table border="0" width="100%" cellpadding="0" cellspacing="0">
                                  <tbody style="display: table-row-group; vertical-align: middle; border-color: inherit;">
                                    <tr v-if="detailOfferData.headline && detailOfferData.headline != '' && detailOfferData.headline != undefined && detailOfferData.headline != null"
                                      style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                      <td align="left" valign="top" style="font-family:Verdana; font-weight:bold; font-size:21px; color:#ff5a00; padding:0 0 8px 0;">
                                        {{ detailOfferData.headline }}
                                      </td>
                                    </tr>
                                    <tr v-if="detailOfferData.copyText && detailOfferData.copyText != '' && detailOfferData.copyText != undefined && detailOfferData.copyText != null"
                                        style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                      <td align="left" valign="top" style="font-family:Verdana; line-height:17px; font-size:13px; color:#000000; padding:0 0 16px 0;">
                                        {{ detailOfferData.copyText }}
                                      </td>
                                    </tr>
                                    <tr v-if="detailOfferData.CTAtext && detailOfferData.CTAtext != '' && detailOfferData.CTAtext != undefined && detailOfferData.CTAtext != null"
                                        style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                      <td align="center" style="padding:0 0 0 0; border-collapse: collapse">
                                        <table style="border-collapse: collapse">
                                          <tbody>
                                            <tr>
                                              <th bgcolor="#ff5a00" style="padding:6px 14px; -webkit-border-radius:4px; border-radius:4px; font-size:14px; 
                                                  font-family:Verdana; color:#ffffff; display:inline-block; border:1px solid #ff5a00;">
                                                <a :href="detailOfferData.destinationURL" style="font-size:14px; font-family:Verdana;line-height:14px; 
                                                    text-decoration:none; font-weight:bold; mso-line-height-rule:exactly; color:#ffffff;" target="_blank"> 
                                                  {{ detailOfferData.CTAtext }}
                                                </a>  
                                              </th>
                                            </tr>
                                          </tbody>
                                        </table>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <!-- Desktop preview ends -->
              </div>
            </div>
          </div>
          <div class="sidebar">
            <div class="base-button greenBackground full-width" style="pointer-events: none">Currently: {{ detailOfferData.statusLive }}</div>
            <div class="spacer-big"></div>
            <v-subheader class="no-padding">Subject Line 1</v-subheader>
            <p v-if="detailOfferData.subject1 && detailOfferData.subject1 != '' && detailOfferData.subject1 != undefined" 
              class="minus-margin">{{ detailOfferData.subject1 }}</p>
            <p v-else><i>Undefined</i></p>
            <v-subheader class="no-padding">Subject Line 2</v-subheader>
            <p v-if="detailOfferData.subject2 && detailOfferData.subject2 != '' && detailOfferData.subject2 != undefined"
              class="minus-margin">{{ detailOfferData.subject2 }}</p>
            <p v-else><i>Undefined</i></p>
            <v-subheader class="no-padding">Preheader</v-subheader>
            <p v-if="detailOfferData.preheader && detailOfferData.preheader != '' && detailOfferData.preheader != undefined"
              class="minus-margin">{{ detailOfferData.preheader }}</p>
            <p v-else><i>Undefined</i></p>
            <div class="spacer-big"></div>
            <div class="spacer-big"></div>
            <v-subheader class="no-padding">Eligibility</v-subheader>
            <template v-if="detailOfferData.eligibility">
              <div v-for="(eligibility, i) in detailOfferData.eligibility" class="display-flex" :key="i">
                <div class="half-width">
                  <p v-if="eligibility.label && eligibility.label != '' && eligibility.label != undefined">
                    <b>{{ eligibility.label }}</b>
                  </p>
                  <p v-else>
                    <b><i>No label</i></b>
                  </p>
                  <p v-if="eligibility.weight && eligibility.weight != '' && eligibility.weight != undefined">
                    Weight {{ eligibility.weight }}
                  </p>
                  <p v-else>
                    <i>No weight</i>
                  </p>
                </div>
                <div class="half-width align-right">
                  <p v-if="eligibility.startDate && eligibility.startDate != '' && eligibility.startDate != undefined">
                    Start: {{ eligibility.startDate | formatDate("M/DD/YYYY") }}
                  </p>
                  <p v-else>
                    Start: --
                  </p>
                  <p v-if="eligibility.endDate && eligibility.endDate != '' && eligibility.endDate != undefined">
                    End: {{ eligibility.endDate | formatDate("M/DD/YYYY") }}
                  </p>
                  <p v-else>
                    End --
                  </p>
                </div>
              </div>
            </template>
            <template v-else>
              <p>There is no eligibility data.</p>
            </template>
          </div>
        </div>
      </v-card>
    </v-dialog>
    <!-- Detailed offer view ends -->

    <!-- New offer  -------------------------------------------------------------------------------------------------------->
    <v-dialog v-model="newOfferDialog" 
              @keydown.esc="newOfferDialog = false"
              width="1200px" height="850px">
      <v-card width="1200px" height="850px" class="display-flex new-offer-dialog">
        <div class="leftSide">
          <p class="dialog-title" style="width: 207px; display: inline-block">Create offer</p>
          <v-container class="dropdownContainerForm">
            <v-select :items="offerTypes"
                      v-model="newOffer.offerType"
                      label="Offer type"
                      item-text="label"
                      item-value="label"
                      dense single-line solo flat
                      class="basicDropdownForm"
                      :menu-props="{contentClass:'basicDropdownContent'}">
            </v-select>
          </v-container>
          <div class="spacer"></div>
          <v-container class="dropdownContainerForm">
            <v-select :items="filters.countries"
                      v-model="newOffer.country"
                      label="Country"
                      item-text="marketLabel"
                      item-value="marketId"
                      dense single-line solo flat 
                      class="basicDropdownForm"
                      :menu-props="{contentClass:'basicDropdownContent'}">
              <template slot="selection" slot-scope="data">
                {{ data.item.marketLabel | maxLength(15) }}
              </template>
            </v-select>
          </v-container>
          <v-container class="dropdownContainerForm">
            <v-select :items="staticFilters.categories"
                      v-model="newOffer.category"
                      label="Category"
                      item-text="categoryLabel"
                      item-value="categoryId"
                      title="categoryLabel"
                      dense single-line solo flat
                      class="basicDropdownForm"
                      :menu-props="{contentClass:'basicDropdownContent'}">
              <template slot="selection" slot-scope="data">
                {{ data.item.categoryLabel | maxLength(15) }}
              </template>
            </v-select>
          </v-container>
          <div class="spacer"></div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.offerLabel"
                          label="Offer Label"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="spacer"></div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.preHeader"
                          label="Pre Header"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.subjectOne"
                          label="Subject line 1"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.subjectTwo"
                          label="Subject line 2"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="spacer"></div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.headline"
                          label="Headline"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.subheadline"
                          label="Subheadline"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="spacer"></div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.imageURL"
                          label="Image URL"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.mobileImageURL"
                          label="Mobile Image URL"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.imageAltText"
                          label="Image Alt Text"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="spacer"></div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.copyText"
                          label="Copy Text"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.CTAText"
                          label="CTA Text"
                          class="basicInput">
            </v-text-field>
          </div>
          <div class="basicInputContainer special full-width">
            <v-text-field v-model="newOffer.destinationURL"
                          label="Destination URL"
                          class="basicInput">
            </v-text-field>
          </div>
        </div>
        <div class="rightSide">
          <p class="dialog-title full-width center-text">Offer preveiw</p>
          <div class="previewContainer">
            <div class="previewContainer-content">

            </div>
          </div>
          <v-btn class="base-button full-width" style="margin-top: 50px;"
            :disabled="!isNewOfferFormValid"
            outline color="#6DC570">
            Create offer
          </v-btn>
        </div>
      </v-card>
    </v-dialog>
    <!-- New offer ends -->

    <!-- Content ends -->

    <!-- Footer -------------------------------------------------------------------------------------------------------->
    <v-footer dark
              height="auto"
              class="footer">
      <v-card flat
              tile
              class="white--text text-xs-center footer-card">
        <v-card-text>
          <template v-for="icon in footerIcons">
            <p class="inline-block footer-icon-text">{{ icon.description }}</p>
            <v-btn  :key="icon.name"
                    class="mx-1 white--text"
                    icon>
              <v-icon size="24px">
                {{ icon.name }}
              </v-icon>
            </v-btn>
          </template>
          
        </v-card-text>
        <v-divider style="margin: 0;"></v-divider>
        <v-card-text class="white--text">
          <br>
          A member of WPP Group. &copy; 2019 â€” <strong>Wunderman</strong>
          <br>
          All Rights Reserved.
          <br><br>
        </v-card-text>
      </v-card>
    </v-footer>
    <!-- Footer ends -->
  </v-app>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <!-- bootstrap -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <!-- vue.js functionalities -->
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>

  <script>
    var vm = new Vue({
      el: '#app',

      filters: {
        maxLength: function(value, desiredLength) {
          if (!value) return '';
          value = value.toString();
          desiredLength = desiredLength*1;
          if(value.length > desiredLength) {
            //console.log('we here')
            return value.substring(0, desiredLength) + '...';
          } else {
            //console.log('we actually here '+ value.length +' '+ desiredLength)
            return value;
          }
        },

        formatDate: function(value, desiredFormat) {
          console.log('we are trying to change: '+value+' into: '+desiredFormat);
          return moment(value).format(desiredFormat);
        }
      },

      props: {
        offers: Array,
        filters: Object,
      },

      data: {
        newOfferDialog: false,
        isLoadingOffers: false,
        detailOfferView: false,
        detailOfferData: {},
        queryStartLine: 0,
        filtersSelected: {
          mco: '',
          umbrella: '',
          country: '',
          category: '',
          status: '',
          label: '',
          lineCount: 12
        },
        newOffer: {
          offerType: '',
          country: '',
          category: '',
          offerLabel: '',
          preHeader: '',
          subjectOne: '',
          subjectTwo: '',
          headline: '',
          subheadline: '',
          imageURL: '',
          mobileImageURL: '',
          imageAltText: '',
          copyText: '',
          CTAText: '',
          destinationURL: '',
        },
        isNewOfferFormValid: false,
        offerTypes: [
          { label: 'Default offer'}
        ],
        sidebar: false,
        subPages: [
          {
            id: 1,
            name: 'Proofing dashboard',
            link: 'file:///C:/Users/antala/Documents/bc_peoject/bc_project/bc_project/campaign-dashboard.html',
            icon: 'list'
          },
          {
            id: 2,
            name: 'Offer dashboard',
            link: 'file:///C:/Users/antala/Documents/bc_peoject/bc_project/bc_project/index.html',
            icon: 'extension'
          },
          {
            id: 4,
            name: 'FAQ',
            link: 'xyz',
            icon: 'help_outline'
          }
        ],
        socialIcons: [
          {
            name: 'tumblr',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/64a84557abe8e5b85db5872cd3f97b20.png"
          },
          {
            name: 'twitter',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/29ff2cc1aaf55cdd7d4d5048831d9ced.png"
          },
          {
            name: 'youtube',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/9f26d4ccd5ef9a6eb1b13ddaaac55069.png"
          },
          {
            name: 'whatsApp',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/96e103e615a88f2f7146aa1b6a29b348.png"
          },
          {
            name: 'facebook',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/ca3264cfa0247c069c8a311056f16c79.png"
          },
          {
            name: 'google',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/e84e8b411d47b36257d0cae80bf90b3e.png"
          },
          {
            name: 'instagram',
            link: "https://unilever-stage.neolane.net/res/unilever_stage/f74da9663a397434375dcea5ad26c2c6.png"
          }
          
        ],
        footerIcons: [
          {
            name: 'email',
            description: 'Email us:'
          },
          {
            name: 'call',
            description: 'Call us:'
          }
        ],
        staticFilters: {
          categories: [
            {
              categoryLabel: 'Recipe Recommendation',
              categoryRef: '_rcr'
            },
            {
              categoryLabel: 'Whitespot - Product',
              categoryRef: '_ws'
            },
            {
              categoryLabel: 'Deepsell',
              categoryRef: '_dps'
            },
            {
              categoryLabel: 'Digital Product Recommendation - Sample',
              categoryRef: '_dpr'
            },
            {
              categoryLabel: 'Hero Articles',
              categoryRef: '_ha'
            },
            {
              categoryLabel: 'Promotion and Activation',
              categoryRef: '_ha_proAct'
            },
            {
              categoryLabel: 'Inspiration',
              categoryRef: '_ha_inspr'
            },
            {
              categoryLabel: 'Secondary Articles',
              categoryRef: '_sa'
            },
            {
              categoryLabel: 'Competitions and Events',
              categoryRef: '_ce'
            },
            {
              categoryLabel: 'Competitions',
              categoryRef: '_ce_com'
            },
            {
              categoryLabel: 'Events',
              categoryRef: '_ce_event'
            },
            {
              categoryLabel: 'Chef Rewards',
              categoryRef: '_cr'
            },
            {
              categoryLabel: 'Chef Rewards Members',
              categoryRef: '_cr_crM'
            },{
              categoryLabel: 'Chef Rewards Non-Members',
              categoryRef: 'cr_crNonM'
            },{
              categoryLabel: 'Retention - Product',
              categoryRef: '_ret'
            },{
              categoryLabel: 'Article - Product',
              categoryRef: '_arc'
            },{
              categoryLabel: 'Recipe Recommendation V02',
              categoryRef: '_rcrv02'
            },{
              categoryLabel: 'Recipe Recommendation V03',
              categoryRef: '_rcrv03'
            },{
              categoryLabel: 'Upsell - Product',
              categoryRef: '_ups'
            },{
              categoryLabel: 'Default',
              categoryRef: 'Default'
            }
          ],
          status: [
            {
              name: 'Live'
            },
            {
              name: 'Disabled'
            }
          ]
        }
      },
      
      watch: {
        'filtersSelected': {
          handler(val) {
            let caller = "filtering";
            this.loadOffers(val, caller);      
          },
          deep: true
        },
        'newOffer': {
          handler(val) {
            this.validateForm();
          },
          deep: true
        }
      },

      created() {
        this.loadFilters();
      },

      mounted() {
        let startPayload = {
          mco: '',
          umbrella: '',
          country: '',
          category: '',
          status: '',
          lineCount: 12,
          label: ''
        };
        this.loadOffers(startPayload, 'filtering');
      },

      methods: {
        loadOffers(payload, caller) {
          let baseUrl = 'https://unilever-stage.neolane.net/ufs/TEST_OfferDashboardGetOffersADAM.jssp';
          let hasUrlBeenAddedTo = false;
          
          console.log(payload)
          console.log(caller)
          if(payload.mco != '' && payload.mco != undefined && payload.mco != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?MCO='+payload.mco;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&MCO='+payload.mco;
            }
          }
          if(payload.umbrella != '' && payload.umbrella != undefined && payload.umbrella != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?umbrella='+payload.umbrella;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&umbrella='+payload.umbrella;
            }
          }
          if(payload.country != '' && payload.country != undefined && payload.country != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?country='+payload.country;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&country='+payload.country;
            }
          }
          if(payload.category != '' && payload.category != undefined && payload.category != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?category='+payload.category;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&category='+payload.category;
            }
          }
          if(payload.status != '' && payload.status != undefined && payload.status != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?status='+payload.status;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&status='+payload.status;
            }
          }
          if(payload.lineCount != '' && payload.lineCount != undefined && payload.lineCount != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?lineCount='+payload.lineCount;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&lineCount='+payload.lineCount;
            }
          }
          if(payload.label != '' && payload.label != undefined && payload.label != null){
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?label='+payload.label;
              hasUrlBeenAddedTo = true;
            }else{
              baseUrl = baseUrl+'&label='+payload.label;
            }
          }

          
          
          if(caller == "loadingMoreOffers"){
            console.log('we loading more offers')
            if(hasUrlBeenAddedTo == false){
              baseUrl = baseUrl+'?startLine='+vm.queryStartLine;
              hasUrlBeenAddedTo = true;

              console.log(baseUrl)
              axios.get(baseUrl).then(function(offerData){
                vm.offers = vm.offers.concat(offerData.data)

              })
            }else{
              baseUrl = baseUrl+'&startLine='+vm.queryStartLine;

              console.log(baseUrl)
              axios.get(baseUrl).then(function(offerData){
                vm.offers = vm.offers.concat(offerData.data)
              })
            }
          }else if(caller == "filtering"){
            console.log(this.queryStartLine)
            this.queryStartLine = 0;

            console.log(baseUrl)
            axios.get(baseUrl).then(function(offerData){
              vm.offers = offerData.data;
              console.log(offerData.data);
            })
          }
        },

        loadMoreOffers() {
        let caller = "loadingMoreOffers";  
        vm.queryStartLine += 12;
        vm.loadOffers(vm.filtersSelected, caller);
        },

        loadFilters() {
          axios.get('https://unilever-stage.neolane.net/ufs/TEST_OfferDashboardGetFilters.jssp').then(function(filterData){
          vm.filters = filterData.data;
          console.log(filterData.data);
          })
        },

        openDetailView(dataForOffer) {
          vm.detailOfferData = dataForOffer;
          vm.detailOfferView = true;
        },

        closeDetailView() {
          vm.detailOfferView = false;
          vm.detailOfferData = {};
        },

        openNewOfferDialog() {
          vm.newOfferDialog = true;
        },

        validateForm() {
          for (var key in vm.newOffer) {
            if(vm.newOffer[key].length < 1){
              if(key == 'offerType' || key == 'country' || key == 'category' || key == 'subjectOne' || key == 'offerLabel') {
                vm.isNewOfferFormValid = false;
                //console.log(key +' is empty and equals to: '+vm.newOffer[key])
                return;
              }else{

              }
            }
          }
          vm.isNewOfferFormValid = true;
        },

        createNewOffer(e) {
          let formData = {name: 'Alex', surname: 'pls'}
          console.log("clicked")
          axios.post('https://unilever-s.neolane.net/ufs/TEST_OfferDashboardCreateOffer.jssp', encodeForm(formData))
          .then(function(response) {
            
            console.log(response)
          })
          .catch(function (error) {
            
            console.log("error")
            console.log(response)
          })
        }

      }
    })
  </script>
</body>

</html>